{% extends layout_path %}
{% block title %}API Concepts (UI){% endblock title %}
{% block content %}
<div class="container-xxl py-4">
  
  <div class="card p-3 mb-3">
    <div class="row g-2">
      <div class="col-md-4"><input id="name" class="form-control" placeholder="Nom du concept"></div>
      <div class="col-md-4"><input id="level" class="form-control" placeholder="Niveau"></div>
      <div class="col-md-4"><button id="btn-create" class="btn btn-success">Créer</button></div>
    </div>
  </div>
  <h5>Concepts existants</h5>
  <ul id="list" class="list-group"></ul>
</div>

<script>
(async function(){
  const list = document.getElementById('list');
  const name = document.getElementById('name');
  const level = document.getElementById('level');
  async function load(){
    const r = await fetch('/api/concepts/');
    const j = await r.json();
    list.innerHTML = '';
    (j.results||[]).forEach(c=>{ const li=document.createElement('li'); li.className='list-group-item'; li.innerHTML = `<strong>${c.name}</strong> <span class='text-muted small'>${c.level||''}</span><div class='small'>${c.description||''}</div>`; list.appendChild(li); });
  }
  document.getElementById('btn-create').addEventListener('click', async ()=>{
    const payload = { name: (name.value||'').trim(), level: (level.value||'').trim(), description: '' };
    if(!payload.name) return alert('Nom requis');
    const r = await fetch('/api/concepts/', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload) });
    if(!r.ok) return alert('Erreur création');
    name.value=''; level.value='';
    await load();
  });
  await load();
})();
</script>
{% endblock content %}
